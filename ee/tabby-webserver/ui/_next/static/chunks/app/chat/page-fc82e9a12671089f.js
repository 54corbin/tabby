(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1929],{78627:function(e,t,n){Promise.resolve().then(n.bind(n,7931))},7931:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var s=n(36164),r=n(3546),o=n(42891),a=n.n(o),i=n(11978),l=n(23342),c=n(94755),d=n(47190),u=n.n(d),m=n(42450),f=n(64148),h=n(93668),p=n(18452),g=n(74248),x=n(31458),v=n(81565),y=n(36613),w=n(73033);n(2596);let E=e=>u()(e).hsl().toString().replace(/hsla?\(/,"").replace(")","").split(",").slice(0,3).map((e,t)=>0===t?parseFloat(e).toFixed(1):e).join(""),b=["vscode"],j=["vscode"];function S(){let[e,t]=(0,r.useState)(!1),[n,o]=(0,r.useState)(null),[d,u]=(0,r.useState)(""),[S,C]=(0,r.useState)([]),[k,N]=(0,r.useState)([]),[K,R]=(0,r.useState)(!1),[M,I]=(0,r.useState)(null),[A,z]=(0,r.useState)(!1),L=(0,r.useRef)(null),[T,_]=(0,r.useState)(!1),{width:F}=(0,c.iP)(),P=(0,r.useRef)(F),U=(0,i.useSearchParams)(),W=U.get("client")||void 0,O=U.get("font-size")||void 0,Z=U.get("foreground")?"#".concat(U.get("foreground")):void 0,B=U.get("background")?"#".concat(U.get("background")):void 0,H="vscode"===W,V="intellij"===W,J=b.includes(W||""),X=j.includes(W||"");(0,r.useEffect)(()=>{let e=e=>{let{data:t}=e;if(t.style){let e=t.style.split(";").filter(e=>e).map(e=>{let[t,n]=e.split(":"),s=n.trim(),r=s.startsWith("#")||s.startsWith("rgb");if(!r)return"".concat(t,": ").concat(n);let o=E(s);return"".concat(t,": ").concat(o)}).join(";");document.documentElement.style.cssText=e,R(!0)}t.themeClass&&(document.documentElement.className=t.themeClass)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,r.useEffect)(()=>{if(!H)return;let e=e=>{(e.ctrlKey||e.metaKey)&&"KeyC"===e.code?document.execCommand("copy"):(e.ctrlKey||e.metaKey)&&"KeyX"===e.code?document.execCommand("cut"):(e.ctrlKey||e.metaKey)&&"KeyV"===e.code?document.execCommand("paste"):(e.ctrlKey||e.metaKey)&&"KeyA"===e.code&&document.execCommand("selectAll")};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]);let q=e=>{if(L.current)L.current.sendUserChat(e);else{let t=[...S];t.push(e),C(t)}},D=e=>{if(L.current)L.current.addRelevantContext(e);else{let t=[...k];t.push(e),N(t)}},G=(0,p.H)({init:e=>{L.current||(u((0,g.x0)()),t(!0),o(e.fetcherOptions))},sendMessage:e=>q(e),showError:e=>{I(e)},cleanError:()=>{I(null)},addRelevantContext:e=>D(e)});(0,r.useLayoutEffect)(()=>{if(T){if(F&&e&&n&&!M&&!P.current){var t;null===(t=L.current)||void 0===t||t.focus()}P.current=F}},[F,T]);let Q=async()=>{z(!0),await (null==G?void 0:G.refresh()),z(!1)},Y=async(e,t)=>{var n;return null==G?void 0:null===(n=G.onSubmitMessage)||void 0===n?void 0:n.call(G,e,t)},$=async e=>{var t;return null==G?void 0:null===(t=G.onApplyInEditor)||void 0===t?void 0:t.call(G,e)};function ee(e){let{children:t}=e;return(0,s.jsxs)("div",{className:"h-screen w-screen",style:{fontSize:K?"inherit":O,color:K?"inherit":Z,background:K?"inherit":B,padding:V?"20px":"5px 18px"},children:[(0,s.jsxs)("div",{className:"flex items-center",style:{marginBottom:"0.55em"},children:[(0,s.jsx)(a(),{src:l.Z,alt:"logo",className:"rounded-full",style:{background:"rgb(232, 226, 210)",marginRight:"0.375em",padding:"0.15em"},width:18}),(0,s.jsx)("p",{className:"font-semibold",children:"Tabby"})]}),t]})}if(M)return(0,s.jsx)(ee,{children:(0,s.jsxs)(s.Fragment,{children:[M.title&&(0,s.jsx)("p",{className:"mb-1.5 mt-2 font-semibold",children:M.title}),(0,s.jsx)(w.s,{className:"prose max-w-none break-words dark:prose-invert prose-p:leading-relaxed prose-pre:mt-1 prose-pre:p-0",remarkPlugins:[f.Z,h.Z],children:M.content}),(0,s.jsxs)(x.z,{className:"mt-5 flex items-center gap-x-2 text-sm leading-none",onClick:Q,children:[A&&(0,s.jsx)(v.IconSpinner,{}),"Refresh"]})]})});if(!e||!n)return(0,s.jsx)(ee,{children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"opacity-80",children:"Welcome to Tabby Chat! Just a moment while we get things ready..."}),(0,s.jsx)(v.IconSpinner,{className:"mx-auto",style:{marginTop:"1.25em",width:"0.875em",height:"0.875em"}})]})});let et={Authorization:"Bearer ".concat(n.authorization)};return(0,s.jsx)(m.SV,{FallbackComponent:function(e){let{error:t}=e;return(0,s.jsxs)(ee,{children:[(0,s.jsx)("p",{className:"mb-1.5 mt-2 font-semibold",children:"Something went wrong"}),(0,s.jsx)("p",{children:t.message}),(0,s.jsxs)(x.z,{className:"mt-5 flex items-center gap-x-2 text-sm leading-none",onClick:Q,children:[A&&(0,s.jsx)(v.IconSpinner,{}),"Refresh"]})]})},children:(0,s.jsx)(y.e,{chatId:d,ref:L,headers:et,onThreadUpdates:()=>{},onNavigateToContext:(e,t)=>{null==G||G.navigate(e,t)},onLoaded:()=>{k.forEach(D),S.forEach(q),N([]),C([]),_(!0)},maxWidth:H?"5xl":void 0,onCopyContent:"vscode"===W?e=>{parent.postMessage({action:"copy",data:e},"*")}:void 0,client:W,onSubmitMessage:J?Y:void 0,onApplyInEditor:X?$:void 0,collectRelevantCodeUsingUserMessage:!0},d)})}},2596:function(){},18452:function(e,t,n){"use strict";n.d(t,{m:function(){return a},H:function(){return i}});var s=n(3546),r=n(89704),o=n(95686);function a(e,t){let[n,o]=(0,s.useState)(null),a=!1;return(0,s.useEffect)(()=>{if(e.current&&!a){var n;a=!0,o((n=e.current,(0,r.K)(n,{expose:{navigate:t.navigate,refresh:t.refresh,onSubmitMessage:t.onSubmitMessage,onApplyInEditor:t.onApplyInEditor}})))}},[e.current]),n}function i(e){let[t,n]=(0,s.useState)(null),r=!1;return(0,s.useEffect)(()=>{let t=window.self!==window.top;t&&!r&&(r=!0,n((0,o.c)({expose:{init:e.init,sendMessage:e.sendMessage,showError:e.showError,cleanError:e.cleanError,addRelevantContext:e.addRelevantContext}})))},[]),t}}},function(e){e.O(0,[7998,5498,1058,530,7980,259,2578,816,1492,4421,7590,1454,5621,4546,8746,9275,4373,5606,6193,4294,4755,2459,9736,1565,6597,7517,3375,5289,1744],function(){return e(e.s=78627)}),_N_E=e.O()}]);